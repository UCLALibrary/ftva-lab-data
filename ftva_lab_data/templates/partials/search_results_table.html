<div class="d-flex justify-content-center align-items-center gap-2">

    <button class="btn btn-primary" {% if page_obj.has_previous %}
        hx-get="{% url 'render_table' %}?page={{ page_obj.previous_page_number }}&search={{ search }}&search_column={{ search_column }}"
        hx-target="#table-container" {% else %} disabled {% endif %}>Previous</button>

    <span>Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>

    <button class="btn btn-primary" {% if page_obj.has_next %}
        hx-get="{% url 'render_table' %}?page={{ page_obj.next_page_number }}&search={{ search }}&search_column={{ search_column }}"
        hx-target="#table-container" {% else %} disabled {% endif %}>Next</button>
</div>


<table class="table table-hover" style="table-layout: fixed;">
    <colgroup>
        <!--Hard drive-->
        <col style="width: 10%;">
        <!--Carrier A-->
        <col style="width: 10%;">
        <!--Carrier B-->
        <col style="width: 10%;">
        <!--File folder-->
        <col style="width: 10%;">
        <!--Sub-folder-->
        <col style="width: 10%;">
        <!--Filename-->
        <col style="width: 10%;">
        <!--Source inv no.-->
        <col style="width: 10%;">
        <!--Status-->
        <col style="width: 11%;">
        <!--Assigned user-->
        <col style="width: 9%;">
        <!--View link and Record ID-->
        <col style="width: 5%;">
        <!--Checkbox for assigning-->
        <col style="width: 5%;">
    </colgroup>
    <thead>
        <tr>
            {% for _, label in columns %}
                {% if label == "Record ID" %}
                    <th></th>
                {% else %}
                    <th>{{ label }}</th>
                {% endif %}
            {% endfor %}
            <th class ="text-center">
                Assign
                <div class="form-check justify-content-center m-0" style="display: flex;" title="Select all items on this page">
                    <input type="checkbox" class="form-check-input checkbox-bold" id="select-all-checkbox">
                </div>
            </th>
        </tr>
    </thead>
    <tbody>
        {% for row in rows %}
        <tr>
            {% for field, value in row.data.items %}
                <td>
                    {% if field == "status" %}
                        {% for status in value %}
                            <span class="badge rounded-pill bg-info text-dark m-1">{{ status }}</span>
                        {% endfor %}
                    {% elif field == "id" %}
                        <div class="d-flex flex-column align-items-start">
                            <!--View link includes search parameters, for later use by "Back to Search" button-->
                            <a class="btn btn-link btn-sm p-0" 
                            href="{% url 'view_item' row.id %}?search={{ search }}&search_column={{ search_column }}&page={{ page_obj.number }}">
                            View</a> 
                            <br>
                            <span class="text-muted small">ID: {{ value }}</span>
                        </div>
                    {% else %}
                        {{ value }}
                    {% endif %}     
                </td>         
            {% endfor %}                    
            <td class="align-top">
                <div class="form-check justify-content-center m-0" style="display: flex;">
                    <input type="checkbox" class="form-check-input row-checkbox checkbox-bold" name="selected_ids" value="{{ row.id }}">
                </div>
            </td>
        </tr>
        {% empty %}
        <tr>
            <td class="text-left" colspan="{{ columns|length|add:1 }}">No results found.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<div class="d-flex justify-content-center align-items-center gap-2">

    <button class="btn btn-primary" {% if page_obj.has_previous %}
        hx-get="{% url 'render_table' %}?page={{ page_obj.previous_page_number }}&search={{ search }}&search_column={{ search_column }}"
        hx-target="#table-container" {% else %} disabled {% endif %}>Previous</button>

    <span>Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>

    <button class="btn btn-primary" {% if page_obj.has_next %}
        hx-get="{% url 'render_table' %}?page={{ page_obj.next_page_number }}&search={{ search }}&search_column={{ search_column }}"
        hx-target="#table-container" {% else %} disabled {% endif %}>Next</button>
</div>

<!-- Hidden input to store the current page number for HTMX requests -->
<!-- Used to maintain state after POST requests to assign items to users -->
<input type="hidden" id="current-page" value="{{ page_obj.number }}">
